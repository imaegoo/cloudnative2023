FROM ghcr.io/graalvm/jdk:ol8-java17-22.3.0 as builder

ADD ./server/ /root/server/
WORKDIR /root/server/
RUN java -version
RUN gu install
RUN bash ./mvnw --batch-mode clean package -Pnative

FROM eclipse-temurin:8-alpine

COPY --from=builder /root/server/target/cloudnative2023 /root/server/target/cloudnative2023
ENTRYPOINT ["/root/server/target/cloudnative2023","-Djavax.xml.accessExternalDTD=all"]
EXPOSE 8080
